import{a as $,b as ie}from"./chunk-APAL4RVN.js";import{a as ne}from"./chunk-PFLDQECG.js";import{b as G,d as Q,h as Y,u as Z}from"./chunk-PMFMPDGG.js";import"./chunk-3VWV52XJ.js";import"./chunk-6ICOT6EK.js";import{Aa as v,Db as z,Ea as B,Ga as b,Ha as u,M as O,Mb as j,Pb as ee,Qb as te,R,Ra as f,S as U,Sa as I,Ta as P,Va as L,W as H,Wa as x,X as g,Xa as E,Y as m,bb as _,cb as h,ea as D,ha as a,ia as k,na as S,pa as y,sb as q,tb as J,ya as r,za as c,zb as X}from"./chunk-S2PF2REC.js";import"./chunk-W7LYWJAE.js";import"./chunk-YT5AF7SN.js";import{d as ce,f as le}from"./chunk-HFBR4SKI.js";var ae=ce((W,F)=>{(function(l,o){typeof define=="function"&&define.amd?define([],o):typeof W<"u"?o():(o(),l.FileSaver={})})(W,function(){"use strict";function l(s,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function o(s,d,C){var p=new XMLHttpRequest;p.open("GET",s),p.responseType="blob",p.onload=function(){K(p.response,d,C)},p.onerror=function(){console.error("could not download file")},p.send()}function i(s){var d=new XMLHttpRequest;d.open("HEAD",s,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function t(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(d)}}var e=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,n=e.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),K=e.saveAs||(typeof window!="object"||window!==e?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(s,d,C){var p=e.URL||e.webkitURL,w=document.createElement("a");d=d||s.name||"download",w.download=d,w.rel="noopener",typeof s=="string"?(w.href=s,w.origin===location.origin?t(w):i(w.href)?o(s,d,C):t(w,w.target="_blank")):(w.href=p.createObjectURL(s),setTimeout(function(){p.revokeObjectURL(w.href)},4e4),setTimeout(function(){t(w)},0))}:"msSaveOrOpenBlob"in navigator?function(s,d,C){if(d=d||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(l(s,C),d);else if(i(s))o(s,d,C);else{var p=document.createElement("a");p.href=s,p.target="_blank",setTimeout(function(){t(p)})}}:function(s,d,C,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof s=="string")return o(s,d,C);var w=s.type==="application/octet-stream",se=/constructor/i.test(e.HTMLElement)||e.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent);if((A||w&&se||n)&&typeof FileReader<"u"){var T=new FileReader;T.onloadend=function(){var M=T.result;M=A?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=M:location=M,p=null},T.readAsDataURL(s)}else{var N=e.URL||e.webkitURL,V=N.createObjectURL(s);p?p.location=V:location.href=V,p=null,setTimeout(function(){N.revokeObjectURL(V)},4e4)}});e.saveAs=K.saveAs=K,typeof F<"u"&&(F.exports=K)})});var oe=le(ae());function pe(l,o){l&1&&(r(0,"div",7)(1,"div",8),v(2,"span",9),c()())}function ue(l,o){l&1&&v(0,"span",40)}function ge(l,o){l&1&&v(0,"span",40)}function me(l,o){l&1&&v(0,"span",40)}function fe(l,o){l&1&&v(0,"span",40)}function _e(l,o){l&1&&v(0,"span",40)}function he(l,o){if(l&1){let i=B();r(0,"div",41),f(1),r(2,"button",42),b("click",function(){let e=g(i).$implicit,n=u(2);return m(n.deleteLanguage(e))}),f(3),_(4,"translate"),c()()}if(l&2){let i=o.$implicit,t=u(2);a(),P(" ",t.languages[i]," "),a(2),I(h(4,2,"admin.pages.configuration.languages.delete_button"))}}function ye(l,o){if(l&1){let i=B();r(0,"div",10)(1,"div",11)(2,"h2"),f(3),_(4,"translate"),c(),r(5,"div",12)(6,"label",13),f(7),_(8,"translate"),c(),r(9,"div",14)(10,"input",15),E("ngModelChange",function(e){g(i);let n=u();return x(n.newPublicKey,e)||(n.newPublicKey=e),m(e)})("valueChange",function(e){g(i);let n=u();return x(n.publicKey,e)||(n.publicKey=e),m(e)}),c(),r(11,"button",16),b("click",function(){g(i);let e=u();return m(e.updatePublicKey())}),S(12,ue,1,0,"span",17),f(13),_(14,"translate"),c()()(),r(15,"div",12)(16,"label",18),f(17),_(18,"translate"),c(),r(19,"div",14)(20,"input",19),E("ngModelChange",function(e){g(i);let n=u();return x(n.newSecretKey,e)||(n.newSecretKey=e),m(e)})("valueChange",function(e){g(i);let n=u();return x(n.secretKey,e)||(n.secretKey=e),m(e)}),c(),r(21,"button",16),b("click",function(){g(i);let e=u();return m(e.updateSecretKey())}),S(22,ge,1,0,"span",17),f(23),_(24,"translate"),c()()(),r(25,"div",12)(26,"label",20),f(27),_(28,"translate"),c(),r(29,"div",14)(30,"input",21),E("ngModelChange",function(e){g(i);let n=u();return x(n.newPriceId_eur,e)||(n.newPriceId_eur=e),m(e)})("valueChange",function(e){g(i);let n=u();return x(n.priceId_eur,e)||(n.priceId_eur=e),m(e)}),c(),r(31,"button",16),b("click",function(){g(i);let e=u();return m(e.updatePriceId("eur"))}),S(32,me,1,0,"span",17),f(33),_(34,"translate"),c()()(),r(35,"div",12)(36,"label",20),f(37),_(38,"translate"),c(),r(39,"div",14)(40,"input",21),E("ngModelChange",function(e){g(i);let n=u();return x(n.newPriceId_usd,e)||(n.newPriceId_usd=e),m(e)})("valueChange",function(e){g(i);let n=u();return x(n.priceId_usd,e)||(n.priceId_usd=e),m(e)}),c(),r(41,"button",16),b("click",function(){g(i);let e=u();return m(e.updatePriceId("usd"))}),S(42,fe,1,0,"span",17),f(43),_(44,"translate"),c()()(),r(45,"div",12)(46,"label",22),f(47,"Price Payment Intent (\u20AC)"),c(),r(48,"div",14)(49,"input",23),E("ngModelChange",function(e){g(i);let n=u();return x(n.formattedPricePaymentIntent,e)||(n.formattedPricePaymentIntent=e),m(e)}),b("input",function(e){g(i);let n=u();return m(n.onPriceInput(e))}),c(),r(50,"button",16),b("click",function(){g(i);let e=u();return m(e.updatePricePaymentIntent())}),S(51,_e,1,0,"span",17),f(52),_(53,"translate"),c()()()(),v(54,"hr",24),r(55,"h3",25),f(56),_(57,"translate"),c(),r(58,"div",26),S(59,he,5,4,"div",27),c(),v(60,"div",28),_(61,"translate"),r(62,"div",29)(63,"div",30)(64,"label",31),f(65),_(66,"translate"),c(),r(67,"input",32),E("ngModelChange",function(e){g(i);let n=u();return x(n.newLanguageCode,e)||(n.newLanguageCode=e),m(e)}),c()(),r(68,"div",33)(69,"label",34),f(70),_(71,"translate"),c(),r(72,"input",35),E("ngModelChange",function(e){g(i);let n=u();return x(n.newLanguageName,e)||(n.newLanguageName=e),m(e)}),c()()(),r(73,"div",36)(74,"div",37)(75,"button",38),b("click",function(){g(i);let e=u();return m(e.addLanguage())}),f(76),_(77,"translate"),c()(),r(78,"div",37)(79,"button",39),b("click",function(){g(i);let e=u();return m(e.downloadEsJson())}),f(80),_(81,"translate"),c()()()()}if(l&2){let i=u();a(3),I(h(4,38,"admin.pages.configuration.stripe.title")),a(4),I(h(8,40,"admin.pages.configuration.stripe.public_key")),a(3),L("ngModel",i.newPublicKey)("value",i.publicKey),y("disabled",i.loading.publicKey),a(2),y("ngIf",i.loading.publicKey),a(),P(" ",h(14,42,"admin.pages.configuration.stripe.update_button")," "),a(4),I(h(18,44,"admin.pages.configuration.stripe.secret_key")),a(3),L("ngModel",i.newSecretKey)("value",i.secretKey),y("disabled",i.loading.secretKey),a(2),y("ngIf",i.loading.secretKey),a(),P(" ",h(24,46,"admin.pages.configuration.stripe.update_button")," "),a(4),P("",h(28,48,"admin.pages.configuration.stripe.price_id")," \u20AC Euro"),a(3),L("ngModel",i.newPriceId_eur)("value",i.priceId_eur),y("disabled",i.loading.priceId_eur),a(2),y("ngIf",i.loading.priceId_eur),a(),P(" ",h(34,50,"admin.pages.configuration.stripe.update_button")," "),a(4),P("",h(38,52,"admin.pages.configuration.stripe.price_id")," $ Usd"),a(3),L("ngModel",i.newPriceId_usd)("value",i.priceId_usd),y("disabled",i.loading.priceId_usd),a(2),y("ngIf",i.loading.priceId_usd),a(),P(" ",h(44,54,"admin.pages.configuration.stripe.update_button")," "),a(6),L("ngModel",i.formattedPricePaymentIntent),y("disabled",i.loading.pricePaymentIntent),a(2),y("ngIf",i.loading.pricePaymentIntent),a(),P(" ",h(53,56,"admin.pages.configuration.stripe.update_button")," "),a(4),I(h(57,58,"admin.pages.configuration.languages.title")),a(3),y("ngForOf",i.getLanguageKeys()),a(),y("innerHTML",h(61,60,"admin.pages.configuration.languages.instructions"),D),a(5),I(h(66,62,"admin.pages.configuration.languages.language_code")),a(2),L("ngModel",i.newLanguageCode),a(3),I(h(71,64,"admin.pages.configuration.languages.language_name")),a(2),L("ngModel",i.newLanguageName),a(4),I(h(77,66,"admin.pages.configuration.languages.add_language")),a(4),I(h(81,68,"admin.pages.configuration.languages.download_json"))}}var re=(()=>{let o=class o{constructor(t,e){this.configService=t,this.http=e,this.publicKey="",this.secretKey="",this.newPublicKey="",this.newSecretKey="",this.formattedPricePaymentIntent="",this.newPricePaymentIntent=0,this.priceId_eur="",this.newPriceId_eur="",this.priceId_usd="",this.newPriceId_usd="",this.loading={publicKey:!1,secretKey:!1,priceId_eur:!1,priceId_usd:!1,pricePaymentIntent:!1},this.languages={},this.newLanguageCode="",this.newLanguageName="",this.fileToUpload=null,this.fileLoading=!1,this.isLoading=!0}ngOnInit(){this.loadConfig(),this.loadLanguages()}loadConfig(){this.configService.getPublicKey().subscribe(t=>{this.publicKey=t,this.newPublicKey=t,this.checkLoading()}),this.configService.getSecretKey().subscribe(t=>{this.secretKey=t,this.newSecretKey=t,this.checkLoading()}),this.configService.getPriceKey("eur").subscribe(t=>{this.priceId_eur=t,this.newPriceId_eur=t,this.checkLoading()}),this.configService.getPriceKey("usd").subscribe(t=>{this.priceId_usd=t,this.newPriceId_usd=t,this.checkLoading()}),this.configService.getPricePaymentIntent().subscribe(t=>{this.newPricePaymentIntent=t,this.updateFormattedPrice(),this.checkLoading()})}onPriceInput(t){let e=t.target.value.replace(/[^0-9.,]/g,""),n=parseFloat(e.replace(",","."));this.newPricePaymentIntent=Math.round(n*100),this.updateFormattedPrice()}updateFormattedPrice(){this.formattedPricePaymentIntent=(this.newPricePaymentIntent/100).toLocaleString("it-IT",{style:"currency",currency:"EUR"})}checkLoading(){this.publicKey&&this.secretKey&&this.languages&&this.priceId_eur&&this.priceId_usd&&this.formattedPricePaymentIntent&&(this.isLoading=!1)}updatePublicKey(){this.loading.publicKey=!0,this.configService.updatePublicKey(this.newPublicKey).then(()=>{this.publicKey=this.newPublicKey,setTimeout(()=>{this.loading.publicKey=!1},500)}).catch(t=>{console.error("Error updating public key:",t)})}updateSecretKey(){this.loading.secretKey=!0,this.configService.updateSecretKey(this.newSecretKey).then(()=>{this.secretKey=this.newSecretKey,setTimeout(()=>{this.loading.secretKey=!1},500)}).catch(t=>{console.error("Error updating secret key:",t)})}updatePriceId(t){this.loading[`priceId_${t}`]=!0;let e="",n="";t==="eur"?(e=this.newPriceId_eur,n=this.priceId_eur):(e=this.newPriceId_usd,n=this.priceId_usd),this.configService.updatePriceKey(e,t).then(()=>{t==="eur"?this.priceId_eur=e:this.priceId_usd=e,setTimeout(()=>{this.loading[`priceId_${t}`]=!1},500)}).catch(K=>{console.error("Error updatin public id:",K)})}updatePricePaymentIntent(){this.loading.pricePaymentIntent=!0,this.configService.updatePricePaymentIntent(this.newPricePaymentIntent).then(()=>{this.updateFormattedPrice(),setTimeout(()=>{this.loading.pricePaymentIntent=!1},500)}).catch(t=>{console.error("Error updatin price payment intent:",t)})}ngOnChanges(){this.loadConfig()}loadLanguages(){this.configService.getLanguages().subscribe(t=>{this.languages=t,this.checkLoading()})}addLanguage(){this.newLanguageCode&&this.newLanguageName&&this.configService.addLanguage(this.newLanguageCode,this.newLanguageName).then(()=>{this.newLanguageCode="",this.newLanguageName="",this.loadLanguages()}).catch(t=>{console.error("Error adding language:",t)})}deleteLanguage(t){this.configService.deleteLanguage(t).then(()=>{this.loadLanguages()}).catch(e=>{console.error("Error deleting language:",e)})}downloadEsJson(){this.http.get("/assets/i18n/es.json",{responseType:"text"}).subscribe(e=>{let n=new Blob([e],{type:"application/json"});(0,oe.saveAs)(n,"es.json")},e=>{console.error("Error downloading es.json:",e)})}getLanguageKeys(){return this.languages?Object.keys(this.languages):[]}};o.\u0275fac=function(e){return new(e||o)(k(ne),k(z))},o.\u0275cmp=R({type:o,selectors:[["app-configuration"]],features:[H],decls:11,vars:5,consts:[[1,"container","d-flex","flex-column","justify-content-start","align-items-start","gap-3","bg-white","rounded-4","shadow-sm","border-1","p-md-5","p-3"],[1,"w-100"],[1,"w-100","d-flex","flex-column","flex-md-row","gap-2","gap-md-0","justify-content-between","align-items-center"],[1,"container-title","fs-2","fw-bold"],[1,"container","mt-4"],["class","d-flex justify-content-center align-items-center","style","height: 100vh;",4,"ngIf"],["class","row",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100vh"],["role","status",1,"spinner-border"],[1,"sr-only"],[1,"row"],[1,"col-md-6"],[1,"form-group","mt-2"],["for","publicKey"],[1,"d-flex","justify-content-center","align-items-center","gap-2"],["type","text","id","publicKey","placeholder","Enter new public key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],[1,"btn","btn-primary","rounded-2","d-flex","justify-content-center","align-items-center","gap-3",3,"click"],["class","spinner-border spinner-border-lg mr-1",4,"ngIf"],["for","secretKey"],["type","text","id","secretKey","placeholder","Enter new secret key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],["for","priceId"],["type","text","id","priceId","placeholder","Enter new secret key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],["for","pricePaymentIntent"],["type","text","id","pricePaymentIntent","placeholder","Enter new price payment",1,"form-control",3,"ngModelChange","input","ngModel","disabled"],[1,"w-100","my-5"],[1,""],[1,"w-100","d-flex","justify-content-start","align-items-center","flex-wrap","gap-3"],["class","d-flex flex-column justify-content-center align-items-center py-3 gap-2 px-4 rounded-2","style","border: 1px solid #c3c3c3;",4,"ngFor","ngForOf"],[3,"innerHTML"],[1,"d-flex","justify-content-center","align-items-center","flex-wrap","mt-4"],[1,"form-group","col-md-3","col-12","px-md-3"],["for","newLanguageCode"],["type","text","id","newLanguageCode","placeholder","Enter language code",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-group","col-md-9","col-12","px-md-3","mt-3","mt-md-0"],["for","newLanguageName"],["type","text","id","newLanguageName","placeholder","Enter language name",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-center","align-items-center","flex-wrap"],[1,"mt-2","col-md-6","col-12","px-3"],[1,"btn","btn-success","w-100","rounded-2",3,"click"],[1,"btn","btn-secondary","w-100","rounded-2",3,"click"],[1,"spinner-border","spinner-border-lg","mr-1"],[1,"d-flex","flex-column","justify-content-center","align-items-center","py-3","gap-2","px-4","rounded-2",2,"border","1px solid #c3c3c3"],[1,"btn","btn-danger","btn-sm","float-right","rounded-2",3,"click"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1),v(2,"app-breadcrumb"),c(),r(3,"div",2)(4,"div",3),f(5),_(6,"translate"),c()(),v(7,"hr",1),r(8,"div",4),S(9,pe,3,0,"div",5)(10,ye,82,70,"div",6),c()()),e&2&&(a(5),P(" ",h(6,3,"admin.pages.configuration.title")," "),a(4),y("ngIf",n.isLoading),a(),y("ngIf",!n.isLoading))},dependencies:[G,Q,Y,q,J,$,ee]});let l=o;return l})();var we=[{path:"",component:re,data:{breadcrumb:"App configuration"}}],ke=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=U({type:o}),o.\u0275inj=O({imports:[j.forChild(we),te,Z,X,ie,j]});let l=o;return l})();export{ke as ConfigurationModule};
