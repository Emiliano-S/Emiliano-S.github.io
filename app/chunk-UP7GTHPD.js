import{a as L}from"./chunk-TJJUDR32.js";import{b as D,c as y,d as G,e as P,i as V,k as W,n as q,t as A,v as R}from"./chunk-PMFMPDGG.js";import"./chunk-3VWV52XJ.js";import"./chunk-6ICOT6EK.js";import{Aa as v,Db as B,Ga as F,Ha as C,M as _,Mb as S,Pb as k,Qb as H,R as x,Ra as m,S as I,Sa as M,Ta as p,Va as N,Wa as E,Xa as T,bb as d,cb as u,ha as n,ia as c,na as h,pa as l,tb as j,ua as w,ya as s,za as o,zb as U}from"./chunk-S2PF2REC.js";import"./chunk-W7LYWJAE.js";import"./chunk-YT5AF7SN.js";import"./chunk-HFBR4SKI.js";function K(e,t){e&1&&v(0,"span",11)}function O(e,t){e&1&&(m(0),d(1,"translate")),e&2&&p(" ",u(1,1,"unsubscribe.button")," ")}function Q(e,t){if(e&1&&(s(0,"div",14),m(1),o()),e&2){let f=C();n(),p(" ",f.successMessage," ")}}function X(e,t){if(e&1&&(s(0,"div",15),m(1),o()),e&2){let f=C();n(),p(" ",f.errorMessage," ")}}var z=(()=>{let t=class t{constructor(a,r,i){this.http=a,this.userService=r,this.fb=i,this.loading=!1,this.unsubForm=this.fb.group({email:["",[y.required,y.email]]})}unsubscribe(){let a="https://us-central1-testiq-abc9f.cloudfunctions.net/unsubscribeFromStripe",r={email:this.email};this.loading=!0,this.http.post(a,r).subscribe(i=>{this.successMessage="\xA1Desuscripci\xF3n exitosa!",this.errorMessage="",this.loading=!1,this.userService.updateSubscriptionStatus(this.email,!1).then(()=>{}).catch(b=>console.error("Error updating subscription status in Firebase:",b))},i=>{console.error("Error al desuscribir",i),this.loading=!1,this.successMessage="",i.status===404?(this.errorMessage="No se encontraron suscripciones para este correo electr\xF3nico.",this.loading=!1):(this.errorMessage="Algo sali\xF3 mal. Por favor, int\xE9ntalo de nuevo m\xE1s tarde.",this.loading=!1)})}};t.\u0275fac=function(r){return new(r||t)(c(B),c(L),c(A))},t.\u0275cmp=x({type:t,selectors:[["app-unsubscribe"]],decls:19,vars:13,consts:[[1,"container","d-flex","justify-content-center","align-items-center"],[1,"bg-white","rounded-4","shadow-sm","border-1","p-md-5","p-3","w-md-50","w-100"],[1,"w-100"],[1,"col-12"],[1,"fw-bold","fs-2"],["novalidate","",1,"needs-validation","mt-3",3,"ngSubmit","formGroup"],[1,"form-group"],["for","email",1,"mb-1"],["type","email","id","email","name","email",1,"form-control",3,"ngModelChange","formControlName","ngModel"],[1,"invalid-feedback"],["type","submit",1,"btn","btn-danger","mt-3",3,"disabled"],[1,"spinner-border","spinner-border-lg","mr-1"],["class","alert alert-success mt-3",4,"ngIf"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"alert","alert-success","mt-3"],[1,"alert","alert-danger","mt-3"]],template:function(r,i){r&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),m(5),d(6,"translate"),o(),s(7,"form",5),F("ngSubmit",function(){return i.unsubscribe()}),s(8,"div",6)(9,"label",7),m(10),d(11,"translate"),o(),s(12,"input",8),T("ngModelChange",function(g){return E(i.email,g)||(i.email=g),g}),o(),v(13,"div",9),o(),s(14,"button",10),h(15,K,1,0,"span",11)(16,O,2,3),o()(),h(17,Q,2,1,"div",12)(18,X,2,1,"div",13),o()()()()),r&2&&(n(5),M(u(6,9,"unsubscribe.title")),n(2),l("formGroup",i.unsubForm),n(3),M(u(11,11,"unsubscribe.form.label")),n(2),l("formControlName","email"),N("ngModel",i.email),n(2),l("disabled",i.unsubForm.invalid),n(),w(i.loading?15:16),n(2),l("ngIf",i.successMessage),n(),l("ngIf",i.errorMessage))},dependencies:[j,V,D,G,P,W,q,k]});let e=t;return e})();var Y=[{path:"",component:z}],ce=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=I({type:t}),t.\u0275inj=_({imports:[S.forChild(Y),H,U,R,S]});let e=t;return e})();export{ce as UnsubscribeModule};
