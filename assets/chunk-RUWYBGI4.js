import{a as $,b as ne}from"./chunk-ZX3RMW2H.js";import{a as ie}from"./chunk-6GAA462R.js";import{b as G,d as Q,h as Y,u as Z}from"./chunk-YHPFCZSM.js";import"./chunk-N3ZOZ4PQ.js";import"./chunk-A2LT4XZZ.js";import{Aa as C,Bb as z,Ea as j,Ga as I,Ha as u,Kb as B,M as A,Nb as ee,Ob as te,R,Ra as f,S as U,Sa as v,Ta as S,Va as L,W as H,Wa as b,X as g,Xa as E,Y as m,bb as _,cb as y,ea as D,ha as a,ia as k,na as P,pa as w,sb as q,tb as J,xb as X,ya as l,za as d}from"./chunk-Y2BQYEOZ.js";import"./chunk-W7LYWJAE.js";import"./chunk-YT5AF7SN.js";import{d as le,f as se}from"./chunk-HFBR4SKI.js";var ae=le((W,F)=>{(function(s,o){typeof define=="function"&&define.amd?define([],o):typeof W<"u"?o():(o(),s.FileSaver={})})(W,function(){"use strict";function s(r,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}function o(r,c,x){var p=new XMLHttpRequest;p.open("GET",r),p.responseType="blob",p.onload=function(){M(p.response,c,x)},p.onerror=function(){console.error("could not download file")},p.send()}function n(r){var c=new XMLHttpRequest;c.open("HEAD",r,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function t(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(c)}}var e=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,i=e.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),M=e.saveAs||(typeof window!="object"||window!==e?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(r,c,x){var p=e.URL||e.webkitURL,h=document.createElement("a");c=c||r.name||"download",h.download=c,h.rel="noopener",typeof r=="string"?(h.href=r,h.origin===location.origin?t(h):n(h.href)?o(r,c,x):t(h,h.target="_blank")):(h.href=p.createObjectURL(r),setTimeout(function(){p.revokeObjectURL(h.href)},4e4),setTimeout(function(){t(h)},0))}:"msSaveOrOpenBlob"in navigator?function(r,c,x){if(c=c||r.name||"download",typeof r!="string")navigator.msSaveOrOpenBlob(s(r,x),c);else if(n(r))o(r,c,x);else{var p=document.createElement("a");p.href=r,p.target="_blank",setTimeout(function(){t(p)})}}:function(r,c,x,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof r=="string")return o(r,c,x);var h=r.type==="application/octet-stream",ce=/constructor/i.test(e.HTMLElement)||e.safari,N=/CriOS\/[\d]+/.test(navigator.userAgent);if((N||h&&ce||i)&&typeof FileReader<"u"){var T=new FileReader;T.onloadend=function(){var K=T.result;K=N?K:K.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=K:location=K,p=null},T.readAsDataURL(r)}else{var O=e.URL||e.webkitURL,V=O.createObjectURL(r);p?p.location=V:location.href=V,p=null,setTimeout(function(){O.revokeObjectURL(V)},4e4)}});e.saveAs=M.saveAs=M,typeof F<"u"&&(F.exports=M)})});var oe=se(ae());function pe(s,o){s&1&&(l(0,"div",7)(1,"div",8),C(2,"span",9),d()())}function ue(s,o){s&1&&C(0,"span",40)}function ge(s,o){s&1&&C(0,"span",40)}function me(s,o){s&1&&C(0,"span",40)}function fe(s,o){s&1&&C(0,"span",40)}function _e(s,o){if(s&1){let n=j();l(0,"div",41),f(1),l(2,"button",42),I("click",function(){let e=g(n).$implicit,i=u(2);return m(i.deleteLanguage(e))}),f(3),_(4,"translate"),d()()}if(s&2){let n=o.$implicit,t=u(2);a(),S(" ",t.languages[n]," "),a(2),v(y(4,2,"admin.pages.configuration.languages.delete_button"))}}function ye(s,o){if(s&1){let n=j();l(0,"div",10)(1,"div",11)(2,"h2"),f(3),_(4,"translate"),d(),l(5,"div",12)(6,"label",13),f(7),_(8,"translate"),d(),l(9,"div",14)(10,"input",15),E("ngModelChange",function(e){g(n);let i=u();return b(i.newPublicKey,e)||(i.newPublicKey=e),m(e)})("valueChange",function(e){g(n);let i=u();return b(i.publicKey,e)||(i.publicKey=e),m(e)}),d(),l(11,"button",16),I("click",function(){g(n);let e=u();return m(e.updatePublicKey())}),P(12,ue,1,0,"span",17),f(13),_(14,"translate"),d()()(),l(15,"div",12)(16,"label",18),f(17),_(18,"translate"),d(),l(19,"div",14)(20,"input",19),E("ngModelChange",function(e){g(n);let i=u();return b(i.newSecretKey,e)||(i.newSecretKey=e),m(e)})("valueChange",function(e){g(n);let i=u();return b(i.secretKey,e)||(i.secretKey=e),m(e)}),d(),l(21,"button",16),I("click",function(){g(n);let e=u();return m(e.updateSecretKey())}),P(22,ge,1,0,"span",17),f(23),_(24,"translate"),d()()(),l(25,"div",12)(26,"label",20),f(27),_(28,"translate"),d(),l(29,"div",14)(30,"input",21),E("ngModelChange",function(e){g(n);let i=u();return b(i.newPriceId,e)||(i.newPriceId=e),m(e)})("valueChange",function(e){g(n);let i=u();return b(i.priceId,e)||(i.priceId=e),m(e)}),d(),l(31,"button",16),I("click",function(){g(n);let e=u();return m(e.updatePriceId())}),P(32,me,1,0,"span",17),f(33),_(34,"translate"),d()()(),l(35,"div",12)(36,"label",22),f(37,"Price Payment Intent (\u20AC)"),d(),l(38,"div",14)(39,"input",23),E("ngModelChange",function(e){g(n);let i=u();return b(i.formattedPricePaymentIntent,e)||(i.formattedPricePaymentIntent=e),m(e)}),I("input",function(e){g(n);let i=u();return m(i.onPriceInput(e))}),d(),l(40,"button",16),I("click",function(){g(n);let e=u();return m(e.updatePricePaymentIntent())}),P(41,fe,1,0,"span",17),f(42),_(43,"translate"),d()()()(),C(44,"hr",24),l(45,"h3",25),f(46),_(47,"translate"),d(),l(48,"div",26),P(49,_e,5,4,"div",27),d(),C(50,"div",28),_(51,"translate"),l(52,"div",29)(53,"div",30)(54,"label",31),f(55),_(56,"translate"),d(),l(57,"input",32),E("ngModelChange",function(e){g(n);let i=u();return b(i.newLanguageCode,e)||(i.newLanguageCode=e),m(e)}),d()(),l(58,"div",33)(59,"label",34),f(60),_(61,"translate"),d(),l(62,"input",35),E("ngModelChange",function(e){g(n);let i=u();return b(i.newLanguageName,e)||(i.newLanguageName=e),m(e)}),d()()(),l(63,"div",36)(64,"div",37)(65,"button",38),I("click",function(){g(n);let e=u();return m(e.addLanguage())}),f(66),_(67,"translate"),d()(),l(68,"div",37)(69,"button",39),I("click",function(){g(n);let e=u();return m(e.downloadEsJson())}),f(70),_(71,"translate"),d()()()()}if(s&2){let n=u();a(3),v(y(4,32,"admin.pages.configuration.stripe.title")),a(4),v(y(8,34,"admin.pages.configuration.stripe.public_key")),a(3),L("ngModel",n.newPublicKey)("value",n.publicKey),w("disabled",n.loading.publicKey),a(2),w("ngIf",n.loading.publicKey),a(),S(" ",y(14,36,"admin.pages.configuration.stripe.update_button")," "),a(4),v(y(18,38,"admin.pages.configuration.stripe.secret_key")),a(3),L("ngModel",n.newSecretKey)("value",n.secretKey),w("disabled",n.loading.secretKey),a(2),w("ngIf",n.loading.secretKey),a(),S(" ",y(24,40,"admin.pages.configuration.stripe.update_button")," "),a(4),v(y(28,42,"admin.pages.configuration.stripe.price_id")),a(3),L("ngModel",n.newPriceId)("value",n.priceId),w("disabled",n.loading.priceId),a(2),w("ngIf",n.loading.priceId),a(),S(" ",y(34,44,"admin.pages.configuration.stripe.update_button")," "),a(6),L("ngModel",n.formattedPricePaymentIntent),w("disabled",n.loading.pricePaymentIntent),a(2),w("ngIf",n.loading.pricePaymentIntent),a(),S(" ",y(43,46,"admin.pages.configuration.stripe.update_button")," "),a(4),v(y(47,48,"admin.pages.configuration.languages.title")),a(3),w("ngForOf",n.getLanguageKeys()),a(),w("innerHTML",y(51,50,"admin.pages.configuration.languages.instructions"),D),a(5),v(y(56,52,"admin.pages.configuration.languages.language_code")),a(2),L("ngModel",n.newLanguageCode),a(3),v(y(61,54,"admin.pages.configuration.languages.language_name")),a(2),L("ngModel",n.newLanguageName),a(4),v(y(67,56,"admin.pages.configuration.languages.add_language")),a(4),v(y(71,58,"admin.pages.configuration.languages.download_json"))}}var re=(()=>{let o=class o{constructor(t,e){this.configService=t,this.http=e,this.publicKey="",this.secretKey="",this.newPublicKey="",this.newSecretKey="",this.formattedPricePaymentIntent="",this.newPricePaymentIntent=0,this.priceId="",this.newPriceId="",this.loading={publicKey:!1,secretKey:!1,priceId:!1,pricePaymentIntent:!1},this.languages={},this.newLanguageCode="",this.newLanguageName="",this.fileToUpload=null,this.fileLoading=!1,this.isLoading=!0}ngOnInit(){this.loadConfig(),this.loadLanguages()}loadConfig(){this.configService.getPublicKey().subscribe(t=>{this.publicKey=t,this.newPublicKey=t,this.checkLoading()}),this.configService.getSecretKey().subscribe(t=>{this.secretKey=t,this.newSecretKey=t,this.checkLoading()}),this.configService.getPriceKey().subscribe(t=>{this.priceId=t,this.newPriceId=t,this.checkLoading()}),this.configService.getPricePaymentIntent().subscribe(t=>{this.newPricePaymentIntent=t,this.updateFormattedPrice(),this.checkLoading()})}onPriceInput(t){let e=t.target.value.replace(/[^0-9.,]/g,""),i=parseFloat(e.replace(",","."));this.newPricePaymentIntent=Math.round(i*100),this.updateFormattedPrice()}updateFormattedPrice(){this.formattedPricePaymentIntent=(this.newPricePaymentIntent/100).toLocaleString("it-IT",{style:"currency",currency:"EUR"})}checkLoading(){this.publicKey&&this.secretKey&&this.languages&&this.priceId&&this.formattedPricePaymentIntent&&(this.isLoading=!1)}updatePublicKey(){this.loading.publicKey=!0,this.configService.updatePublicKey(this.newPublicKey).then(()=>{this.publicKey=this.newPublicKey,setTimeout(()=>{this.loading.publicKey=!1},500)}).catch(t=>{console.error("Error updating public key:",t)})}updateSecretKey(){this.loading.secretKey=!0,this.configService.updateSecretKey(this.newSecretKey).then(()=>{this.secretKey=this.newSecretKey,setTimeout(()=>{this.loading.secretKey=!1},500)}).catch(t=>{console.error("Error updating secret key:",t)})}updatePriceId(){this.loading.priceId=!0,this.configService.updatePriceKey(this.newPriceId).then(()=>{this.priceId=this.newPriceId,setTimeout(()=>{this.loading.priceId=!1},500)}).catch(t=>{console.error("Error updatin public id:",t)})}updatePricePaymentIntent(){this.loading.pricePaymentIntent=!0,this.configService.updatePricePaymentIntent(this.newPricePaymentIntent).then(()=>{this.updateFormattedPrice(),setTimeout(()=>{this.loading.pricePaymentIntent=!1},500)}).catch(t=>{console.error("Error updatin price payment intent:",t)})}ngOnChanges(){this.loadConfig()}loadLanguages(){this.configService.getLanguages().subscribe(t=>{this.languages=t,this.checkLoading()})}addLanguage(){this.newLanguageCode&&this.newLanguageName&&this.configService.addLanguage(this.newLanguageCode,this.newLanguageName).then(()=>{this.newLanguageCode="",this.newLanguageName="",this.loadLanguages()}).catch(t=>{console.error("Error adding language:",t)})}deleteLanguage(t){this.configService.deleteLanguage(t).then(()=>{this.loadLanguages()}).catch(e=>{console.error("Error deleting language:",e)})}downloadEsJson(){this.http.get("/assets/i18n/es.json",{responseType:"text"}).subscribe(e=>{let i=new Blob([e],{type:"application/json"});(0,oe.saveAs)(i,"es.json")},e=>{console.error("Error downloading es.json:",e)})}getLanguageKeys(){return this.languages?Object.keys(this.languages):[]}};o.\u0275fac=function(e){return new(e||o)(k(ie),k(z))},o.\u0275cmp=R({type:o,selectors:[["app-configuration"]],features:[H],decls:11,vars:5,consts:[[1,"container","d-flex","flex-column","justify-content-start","align-items-start","gap-3","bg-white","rounded-4","shadow-sm","border-1","p-md-5","p-3"],[1,"w-100"],[1,"w-100","d-flex","flex-column","flex-md-row","gap-2","gap-md-0","justify-content-between","align-items-center"],[1,"container-title","fs-2","fw-bold"],[1,"container","mt-4"],["class","d-flex justify-content-center align-items-center","style","height: 100vh;",4,"ngIf"],["class","row",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100vh"],["role","status",1,"spinner-border"],[1,"sr-only"],[1,"row"],[1,"col-md-6"],[1,"form-group","mt-2"],["for","publicKey"],[1,"d-flex","justify-content-center","align-items-center","gap-2"],["type","text","id","publicKey","placeholder","Enter new public key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],[1,"btn","btn-primary","rounded-2","d-flex","justify-content-center","align-items-center","gap-3",3,"click"],["class","spinner-border spinner-border-lg mr-1",4,"ngIf"],["for","secretKey"],["type","text","id","secretKey","placeholder","Enter new secret key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],["for","priceId"],["type","text","id","priceId","placeholder","Enter new secret key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],["for","pricePaymentIntent"],["type","text","id","pricePaymentIntent","placeholder","Enter new price payment",1,"form-control",3,"ngModelChange","input","ngModel","disabled"],[1,"w-100","my-5"],[1,""],[1,"w-100","d-flex","justify-content-start","align-items-center","flex-wrap","gap-3"],["class","d-flex flex-column justify-content-center align-items-center py-3 gap-2 px-4 rounded-2","style","border: 1px solid #c3c3c3;",4,"ngFor","ngForOf"],[3,"innerHTML"],[1,"d-flex","justify-content-center","align-items-center","flex-wrap","mt-4"],[1,"form-group","col-md-3","col-12","px-md-3"],["for","newLanguageCode"],["type","text","id","newLanguageCode","placeholder","Enter language code",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-group","col-md-9","col-12","px-md-3","mt-3","mt-md-0"],["for","newLanguageName"],["type","text","id","newLanguageName","placeholder","Enter language name",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-center","align-items-center","flex-wrap"],[1,"mt-2","col-md-6","col-12","px-3"],[1,"btn","btn-success","w-100","rounded-2",3,"click"],[1,"btn","btn-secondary","w-100","rounded-2",3,"click"],[1,"spinner-border","spinner-border-lg","mr-1"],[1,"d-flex","flex-column","justify-content-center","align-items-center","py-3","gap-2","px-4","rounded-2",2,"border","1px solid #c3c3c3"],[1,"btn","btn-danger","btn-sm","float-right","rounded-2",3,"click"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1),C(2,"app-breadcrumb"),d(),l(3,"div",2)(4,"div",3),f(5),_(6,"translate"),d()(),C(7,"hr",1),l(8,"div",4),P(9,pe,3,0,"div",5)(10,ye,72,60,"div",6),d()()),e&2&&(a(5),S(" ",y(6,3,"admin.pages.configuration.title")," "),a(4),w("ngIf",i.isLoading),a(),w("ngIf",!i.isLoading))},dependencies:[G,Q,Y,q,J,$,ee]});let s=o;return s})();var he=[{path:"",component:re,data:{breadcrumb:"App configuration"}}],Ve=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=U({type:o}),o.\u0275inj=A({imports:[B.forChild(he),te,Z,X,ne,B]});let s=o;return s})();export{Ve as ConfigurationModule};
