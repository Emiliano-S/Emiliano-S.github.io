import{a as W}from"./chunk-ROYPM5SJ.js";import{b as U,c as S,d as B,e as D,i as j,k as G,n as P,t as V}from"./chunk-URMEJ6Q5.js";import{Aa as h,Ab as N,Ga as x,Ha as _,Mb as T,R as y,Ra as l,Sa as C,Ta as d,Va as I,Wa as w,Xa as E,cb as p,db as u,ha as i,ia as c,na as v,pa as a,sb as F,ua as M,ya as o,za as r}from"./chunk-DZ73TETG.js";function q(t,n){t&1&&h(0,"span",11)}function A(t,n){t&1&&(l(0),p(1,"translate")),t&2&&d(" ",u(1,1,"unsubscribe.button")," ")}function k(t,n){if(t&1&&(o(0,"div",14),l(1),r()),t&2){let f=_();i(),d(" ",f.successMessage," ")}}function H(t,n){if(t&1&&(o(0,"div",15),l(1),r()),t&2){let f=_();i(),d(" ",f.errorMessage," ")}}var X=(()=>{let n=class n{constructor(m,s,e){this.http=m,this.userService=s,this.fb=e,this.loading=!1,this.unsubForm=this.fb.group({email:["",[S.required,S.email]]})}unsubscribe(){let m="https://us-central1-testiq-abc9f.cloudfunctions.net/unsubscribeFromStripe",s={email:this.email};this.loading=!0,this.http.post(m,s).subscribe(e=>{this.successMessage="\xA1Desuscripci\xF3n exitosa!",this.errorMessage="",this.loading=!1,this.userService.updateSubscriptionStatus(this.email,!1).then(()=>{}).catch(b=>console.error("Error updating subscription status in Firebase:",b))},e=>{console.error("Error al desuscribir",e),this.loading=!1,this.successMessage="",e.status===404?(this.errorMessage="No se encontraron suscripciones para este correo electr\xF3nico.",this.loading=!1):(this.errorMessage="Algo sali\xF3 mal. Por favor, int\xE9ntalo de nuevo m\xE1s tarde.",this.loading=!1)})}};n.\u0275fac=function(s){return new(s||n)(c(N),c(W),c(V))},n.\u0275cmp=y({type:n,selectors:[["app-unsubscribe"]],decls:19,vars:13,consts:[[1,"container","d-flex","justify-content-center","align-items-center"],[1,"bg-white","rounded-4","shadow-sm","border-1","p-md-5","p-3","w-md-50","w-100"],[1,"w-100"],[1,"col-12"],[1,"fw-bold","fs-2"],["novalidate","",1,"needs-validation","mt-3",3,"ngSubmit","formGroup"],[1,"form-group"],["for","email",1,"mb-1"],["type","email","id","email","name","email",1,"form-control",3,"ngModelChange","formControlName","ngModel"],[1,"invalid-feedback"],["type","submit",1,"btn","btn-danger","mt-3",3,"disabled"],[1,"spinner-border","spinner-border-lg","mr-1"],["class","alert alert-success mt-3",4,"ngIf"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"alert","alert-success","mt-3"],[1,"alert","alert-danger","mt-3"]],template:function(s,e){s&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),l(5),p(6,"translate"),r(),o(7,"form",5),x("ngSubmit",function(){return e.unsubscribe()}),o(8,"div",6)(9,"label",7),l(10),p(11,"translate"),r(),o(12,"input",8),E("ngModelChange",function(g){return w(e.email,g)||(e.email=g),g}),r(),h(13,"div",9),r(),o(14,"button",10),v(15,q,1,0,"span",11)(16,A,2,3),r()(),v(17,k,2,1,"div",12)(18,H,2,1,"div",13),r()()()()),s&2&&(i(5),C(u(6,9,"unsubscribe.title")),i(2),a("formGroup",e.unsubForm),i(3),C(u(11,11,"unsubscribe.form.label")),i(2),a("formControlName","email"),I("ngModel",e.email),i(2),a("disabled",e.unsubForm.invalid),i(),M(e.loading?15:16),i(2),a("ngIf",e.successMessage),i(),a("ngIf",e.errorMessage))},dependencies:[F,j,U,B,D,G,P,T]});let t=n;return t})();export{X as a};
//# sourceMappingURL=chunk-C2L4RHTX.js.map
