import{a as G}from"./chunk-ZZKZR4PJ.js";import{a as Q}from"./chunk-Z4MPAOXA.js";import{b as J,d as X,h as z}from"./chunk-BSLL5DOT.js";import{Aa as C,Ab as D,Ea as B,Ga as I,Ha as u,Mb as q,R as A,Ra as f,Sa as v,Ta as S,Va as L,W as N,Wa as b,X as g,Xa as E,Y as m,cb as _,db as y,ea as R,ha as a,ia as k,na as P,pa as w,rb as U,sb as H,ya as c,za as l}from"./chunk-QE4JIREK.js";import{d as ee,f as te}from"./chunk-HFBR4SKI.js";var Y=ee((j,W)=>{(function(d,p){typeof define=="function"&&define.amd?define([],p):typeof j<"u"?p():(p(),d.FileSaver={})})(j,function(){"use strict";function d(o,r){return typeof r>"u"?r={autoBom:!1}:typeof r!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function p(o,r,x){var s=new XMLHttpRequest;s.open("GET",o),s.responseType="blob",s.onload=function(){M(s.response,r,x)},s.onerror=function(){console.error("could not download file")},s.send()}function n(o){var r=new XMLHttpRequest;r.open("HEAD",o,!1);try{r.send()}catch{}return 200<=r.status&&299>=r.status}function t(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(r)}}var e=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,i=e.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),M=e.saveAs||(typeof window!="object"||window!==e?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(o,r,x){var s=e.URL||e.webkitURL,h=document.createElement("a");r=r||o.name||"download",h.download=r,h.rel="noopener",typeof o=="string"?(h.href=o,h.origin===location.origin?t(h):n(h.href)?p(o,r,x):t(h,h.target="_blank")):(h.href=s.createObjectURL(o),setTimeout(function(){s.revokeObjectURL(h.href)},4e4),setTimeout(function(){t(h)},0))}:"msSaveOrOpenBlob"in navigator?function(o,r,x){if(r=r||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(d(o,x),r);else if(n(o))p(o,r,x);else{var s=document.createElement("a");s.href=o,s.target="_blank",setTimeout(function(){t(s)})}}:function(o,r,x,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),typeof o=="string")return p(o,r,x);var h=o.type==="application/octet-stream",$=/constructor/i.test(e.HTMLElement)||e.safari,F=/CriOS\/[\d]+/.test(navigator.userAgent);if((F||h&&$||i)&&typeof FileReader<"u"){var T=new FileReader;T.onloadend=function(){var K=T.result;K=F?K:K.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=K:location=K,s=null},T.readAsDataURL(o)}else{var O=e.URL||e.webkitURL,V=O.createObjectURL(o);s?s.location=V:location.href=V,s=null,setTimeout(function(){O.revokeObjectURL(V)},4e4)}});e.saveAs=M.saveAs=M,typeof W<"u"&&(W.exports=M)})});var Z=te(Y());function ne(d,p){d&1&&(c(0,"div",7)(1,"div",8),C(2,"span",9),l()())}function ie(d,p){d&1&&C(0,"span",40)}function ae(d,p){d&1&&C(0,"span",40)}function oe(d,p){d&1&&C(0,"span",40)}function re(d,p){d&1&&C(0,"span",40)}function ce(d,p){if(d&1){let n=B();c(0,"div",41),f(1),c(2,"button",42),I("click",function(){let e=g(n).$implicit,i=u(2);return m(i.deleteLanguage(e))}),f(3),_(4,"translate"),l()()}if(d&2){let n=p.$implicit,t=u(2);a(),S(" ",t.languages[n]," "),a(2),v(y(4,2,"admin.pages.configuration.languages.delete_button"))}}function le(d,p){if(d&1){let n=B();c(0,"div",10)(1,"div",11)(2,"h2"),f(3),_(4,"translate"),l(),c(5,"div",12)(6,"label",13),f(7),_(8,"translate"),l(),c(9,"div",14)(10,"input",15),E("ngModelChange",function(e){g(n);let i=u();return b(i.newPublicKey,e)||(i.newPublicKey=e),m(e)})("valueChange",function(e){g(n);let i=u();return b(i.publicKey,e)||(i.publicKey=e),m(e)}),l(),c(11,"button",16),I("click",function(){g(n);let e=u();return m(e.updatePublicKey())}),P(12,ie,1,0,"span",17),f(13),_(14,"translate"),l()()(),c(15,"div",12)(16,"label",18),f(17),_(18,"translate"),l(),c(19,"div",14)(20,"input",19),E("ngModelChange",function(e){g(n);let i=u();return b(i.newSecretKey,e)||(i.newSecretKey=e),m(e)})("valueChange",function(e){g(n);let i=u();return b(i.secretKey,e)||(i.secretKey=e),m(e)}),l(),c(21,"button",16),I("click",function(){g(n);let e=u();return m(e.updateSecretKey())}),P(22,ae,1,0,"span",17),f(23),_(24,"translate"),l()()(),c(25,"div",12)(26,"label",20),f(27),_(28,"translate"),l(),c(29,"div",14)(30,"input",21),E("ngModelChange",function(e){g(n);let i=u();return b(i.newPriceId,e)||(i.newPriceId=e),m(e)})("valueChange",function(e){g(n);let i=u();return b(i.priceId,e)||(i.priceId=e),m(e)}),l(),c(31,"button",16),I("click",function(){g(n);let e=u();return m(e.updatePriceId())}),P(32,oe,1,0,"span",17),f(33),_(34,"translate"),l()()(),c(35,"div",12)(36,"label",22),f(37,"Price Payment Intent (\u20AC)"),l(),c(38,"div",14)(39,"input",23),E("ngModelChange",function(e){g(n);let i=u();return b(i.formattedPricePaymentIntent,e)||(i.formattedPricePaymentIntent=e),m(e)}),I("input",function(e){g(n);let i=u();return m(i.onPriceInput(e))}),l(),c(40,"button",16),I("click",function(){g(n);let e=u();return m(e.updatePricePaymentIntent())}),P(41,re,1,0,"span",17),f(42),_(43,"translate"),l()()()(),C(44,"hr",24),c(45,"h3",25),f(46),_(47,"translate"),l(),c(48,"div",26),P(49,ce,5,4,"div",27),l(),C(50,"div",28),_(51,"translate"),c(52,"div",29)(53,"div",30)(54,"label",31),f(55),_(56,"translate"),l(),c(57,"input",32),E("ngModelChange",function(e){g(n);let i=u();return b(i.newLanguageCode,e)||(i.newLanguageCode=e),m(e)}),l()(),c(58,"div",33)(59,"label",34),f(60),_(61,"translate"),l(),c(62,"input",35),E("ngModelChange",function(e){g(n);let i=u();return b(i.newLanguageName,e)||(i.newLanguageName=e),m(e)}),l()()(),c(63,"div",36)(64,"div",37)(65,"button",38),I("click",function(){g(n);let e=u();return m(e.addLanguage())}),f(66),_(67,"translate"),l()(),c(68,"div",37)(69,"button",39),I("click",function(){g(n);let e=u();return m(e.downloadEsJson())}),f(70),_(71,"translate"),l()()()()}if(d&2){let n=u();a(3),v(y(4,32,"admin.pages.configuration.stripe.title")),a(4),v(y(8,34,"admin.pages.configuration.stripe.public_key")),a(3),L("ngModel",n.newPublicKey)("value",n.publicKey),w("disabled",n.loading.publicKey),a(2),w("ngIf",n.loading.publicKey),a(),S(" ",y(14,36,"admin.pages.configuration.stripe.update_button")," "),a(4),v(y(18,38,"admin.pages.configuration.stripe.secret_key")),a(3),L("ngModel",n.newSecretKey)("value",n.secretKey),w("disabled",n.loading.secretKey),a(2),w("ngIf",n.loading.secretKey),a(),S(" ",y(24,40,"admin.pages.configuration.stripe.update_button")," "),a(4),v(y(28,42,"admin.pages.configuration.stripe.price_id")),a(3),L("ngModel",n.newPriceId)("value",n.priceId),w("disabled",n.loading.priceId),a(2),w("ngIf",n.loading.priceId),a(),S(" ",y(34,44,"admin.pages.configuration.stripe.update_button")," "),a(6),L("ngModel",n.formattedPricePaymentIntent),w("disabled",n.loading.pricePaymentIntent),a(2),w("ngIf",n.loading.pricePaymentIntent),a(),S(" ",y(43,46,"admin.pages.configuration.stripe.update_button")," "),a(4),v(y(47,48,"admin.pages.configuration.languages.title")),a(3),w("ngForOf",n.getLanguageKeys()),a(),w("innerHTML",y(51,50,"admin.pages.configuration.languages.instructions"),R),a(5),v(y(56,52,"admin.pages.configuration.languages.language_code")),a(2),L("ngModel",n.newLanguageCode),a(3),v(y(61,54,"admin.pages.configuration.languages.language_name")),a(2),L("ngModel",n.newLanguageName),a(4),v(y(67,56,"admin.pages.configuration.languages.add_language")),a(4),v(y(71,58,"admin.pages.configuration.languages.download_json"))}}var _e=(()=>{let p=class p{constructor(t,e){this.configService=t,this.http=e,this.publicKey="",this.secretKey="",this.newPublicKey="",this.newSecretKey="",this.formattedPricePaymentIntent="",this.newPricePaymentIntent=0,this.priceId="",this.newPriceId="",this.loading={publicKey:!1,secretKey:!1,priceId:!1,pricePaymentIntent:!1},this.languages={},this.newLanguageCode="",this.newLanguageName="",this.fileToUpload=null,this.fileLoading=!1,this.isLoading=!0}ngOnInit(){this.loadConfig(),this.loadLanguages()}loadConfig(){this.configService.getPublicKey().subscribe(t=>{this.publicKey=t,this.newPublicKey=t,this.checkLoading()}),this.configService.getSecretKey().subscribe(t=>{this.secretKey=t,this.newSecretKey=t,this.checkLoading()}),this.configService.getPriceKey().subscribe(t=>{this.priceId=t,this.newPriceId=t,this.checkLoading()}),this.configService.getPricePaymentIntent().subscribe(t=>{this.newPricePaymentIntent=t,this.updateFormattedPrice(),this.checkLoading()})}onPriceInput(t){let e=t.target.value.replace(/[^0-9.,]/g,""),i=parseFloat(e.replace(",","."));this.newPricePaymentIntent=Math.round(i*100),this.updateFormattedPrice()}updateFormattedPrice(){this.formattedPricePaymentIntent=(this.newPricePaymentIntent/100).toLocaleString("it-IT",{style:"currency",currency:"EUR"})}checkLoading(){this.publicKey&&this.secretKey&&this.languages&&this.priceId&&this.formattedPricePaymentIntent&&(this.isLoading=!1)}updatePublicKey(){this.loading.publicKey=!0,this.configService.updatePublicKey(this.newPublicKey).then(()=>{this.publicKey=this.newPublicKey,setTimeout(()=>{this.loading.publicKey=!1},500)}).catch(t=>{console.error("Error updating public key:",t)})}updateSecretKey(){this.loading.secretKey=!0,this.configService.updateSecretKey(this.newSecretKey).then(()=>{this.secretKey=this.newSecretKey,setTimeout(()=>{this.loading.secretKey=!1},500)}).catch(t=>{console.error("Error updating secret key:",t)})}updatePriceId(){this.loading.priceId=!0,this.configService.updatePriceKey(this.newPriceId).then(()=>{this.priceId=this.newPriceId,setTimeout(()=>{this.loading.priceId=!1},500)}).catch(t=>{console.error("Error updatin public id:",t)})}updatePricePaymentIntent(){this.loading.pricePaymentIntent=!0,this.configService.updatePricePaymentIntent(this.newPricePaymentIntent).then(()=>{this.updateFormattedPrice(),setTimeout(()=>{this.loading.pricePaymentIntent=!1},500)}).catch(t=>{console.error("Error updatin price payment intent:",t)})}ngOnChanges(){this.loadConfig()}loadLanguages(){this.configService.getLanguages().subscribe(t=>{this.languages=t,this.checkLoading()})}addLanguage(){this.newLanguageCode&&this.newLanguageName&&this.configService.addLanguage(this.newLanguageCode,this.newLanguageName).then(()=>{this.newLanguageCode="",this.newLanguageName="",this.loadLanguages()}).catch(t=>{console.error("Error adding language:",t)})}deleteLanguage(t){this.configService.deleteLanguage(t).then(()=>{this.loadLanguages()}).catch(e=>{console.error("Error deleting language:",e)})}downloadEsJson(){this.http.get("/assets/i18n/es.json",{responseType:"text"}).subscribe(e=>{let i=new Blob([e],{type:"application/json"});(0,Z.saveAs)(i,"es.json")},e=>{console.error("Error downloading es.json:",e)})}getLanguageKeys(){return this.languages?Object.keys(this.languages):[]}};p.\u0275fac=function(e){return new(e||p)(k(Q),k(D))},p.\u0275cmp=A({type:p,selectors:[["app-configuration"]],features:[N],decls:11,vars:5,consts:[[1,"container","d-flex","flex-column","justify-content-start","align-items-start","gap-3","bg-white","rounded-4","shadow-sm","border-1","p-md-5","p-3"],[1,"w-100"],[1,"w-100","d-flex","flex-column","flex-md-row","gap-2","gap-md-0","justify-content-between","align-items-center"],[1,"container-title","fs-2","fw-bold"],[1,"container","mt-4"],["class","d-flex justify-content-center align-items-center","style","height: 100vh;",4,"ngIf"],["class","row",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100vh"],["role","status",1,"spinner-border"],[1,"sr-only"],[1,"row"],[1,"col-md-6"],[1,"form-group","mt-2"],["for","publicKey"],[1,"d-flex","justify-content-center","align-items-center","gap-2"],["type","text","id","publicKey","placeholder","Enter new public key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],[1,"btn","btn-primary","rounded-2","d-flex","justify-content-center","align-items-center","gap-3",3,"click"],["class","spinner-border spinner-border-lg mr-1",4,"ngIf"],["for","secretKey"],["type","text","id","secretKey","placeholder","Enter new secret key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],["for","priceId"],["type","text","id","priceId","placeholder","Enter new secret key",1,"form-control",3,"ngModelChange","valueChange","ngModel","value","disabled"],["for","pricePaymentIntent"],["type","text","id","pricePaymentIntent","placeholder","Enter new price payment",1,"form-control",3,"ngModelChange","input","ngModel","disabled"],[1,"w-100","my-5"],[1,""],[1,"w-100","d-flex","justify-content-start","align-items-center","flex-wrap","gap-3"],["class","d-flex flex-column justify-content-center align-items-center py-3 gap-2 px-4 rounded-2","style","border: 1px solid #c3c3c3;",4,"ngFor","ngForOf"],[3,"innerHTML"],[1,"d-flex","justify-content-center","align-items-center","flex-wrap","mt-4"],[1,"form-group","col-md-3","col-12","px-md-3"],["for","newLanguageCode"],["type","text","id","newLanguageCode","placeholder","Enter language code",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-group","col-md-9","col-12","px-md-3","mt-3","mt-md-0"],["for","newLanguageName"],["type","text","id","newLanguageName","placeholder","Enter language name",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-center","align-items-center","flex-wrap"],[1,"mt-2","col-md-6","col-12","px-3"],[1,"btn","btn-success","w-100","rounded-2",3,"click"],[1,"btn","btn-secondary","w-100","rounded-2",3,"click"],[1,"spinner-border","spinner-border-lg","mr-1"],[1,"d-flex","flex-column","justify-content-center","align-items-center","py-3","gap-2","px-4","rounded-2",2,"border","1px solid #c3c3c3"],[1,"btn","btn-danger","btn-sm","float-right","rounded-2",3,"click"]],template:function(e,i){e&1&&(c(0,"div",0)(1,"div",1),C(2,"app-breadcrumb"),l(),c(3,"div",2)(4,"div",3),f(5),_(6,"translate"),l()(),C(7,"hr",1),c(8,"div",4),P(9,ne,3,0,"div",5)(10,le,72,60,"div",6),l()()),e&2&&(a(5),S(" ",y(6,3,"admin.pages.configuration.title")," "),a(4),w("ngIf",i.isLoading),a(),w("ngIf",!i.isLoading))},dependencies:[U,H,J,X,z,G,q]});let d=p;return d})();export{_e as a};
